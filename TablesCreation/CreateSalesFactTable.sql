CREATE TABLE Sales_Fact (
    SalesFactID BIGINT IDENTITY(1,1) PRIMARY KEY,

    -- Dimension Keys
    DateKey INT NOT NULL,
    CustomerKey INT NOT NULL,
    ProductKey INT NOT NULL,

    -- Measures
    Quantity INT NOT NULL CHECK (Quantity > 0),
    UnitPrice DECIMAL(10,2) NOT NULL CHECK (UnitPrice >= 0),
    TotalSalesAmount DECIMAL(12,2) NOT NULL,
    DiscountAmount DECIMAL(10,2) DEFAULT 0,
    NetSalesAmount DECIMAL(12,2) NOT NULL,

    -- Audit columns
    LoadDate DATETIME DEFAULT GETDATE(),
    SourceSystem VARCHAR(50)
);

INSERT INTO Sales_Fact
(DateKey, CustomerKey, ProductKey, Quantity, UnitPrice, TotalSalesAmount, DiscountAmount, NetSalesAmount, SourceSystem)
VALUES
(20250101, 101, 1001, 2, 55000, 110000, 5000, 105000, 'OLTP_SALES'),
(20250102, 102, 1002, 1, 28000, 28000, 0, 28000, 'OLTP_SALES'),
(20250103, 103, 1003, 3, 1200, 3600, 300, 3300, 'OLTP_SALES'),
(20250104, 104, 1004, 2, 9500, 19000, 1000, 18000, 'OLTP_SALES'),
(20250105, 105, 1005, 4, 600, 2400, 0, 2400, 'OLTP_SALES'),

(20250106, 106, 1006, 1, 16000, 16000, 500, 15500, 'OLTP_SALES'),
(20250107, 107, 1007, 2, 3500, 7000, 0, 7000, 'OLTP_SALES'),
(20250108, 108, 1008, 3, 2500, 7500, 750, 6750, 'OLTP_SALES'),
(20250109, 109, 1009, 1, 4200, 4200, 0, 4200, 'OLTP_SALES'),
(20250110, 110, 1010, 2, 8000, 16000, 2000, 14000, 'OLTP_SALES'),

(20250111, 111, 1011, 1, 60000, 60000, 3000, 57000, 'OLTP_SALES'),
(20250112, 112, 1012, 5, 1500, 7500, 0, 7500, 'OLTP_SALES'),
(20250113, 113, 1013, 1, 45000, 45000, 5000, 40000, 'OLTP_SALES'),
(20250114, 114, 1014, 2, 6500, 13000, 0, 13000, 'OLTP_SALES'),
(20250115, 115, 1015, 1, 18000, 18000, 1500, 16500, 'OLTP_SALES');
